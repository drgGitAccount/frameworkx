class Collapse{constructor(e,t={}){this.element=e,this.options={toggle:!0,parent:null,...t},this.isTransitioning=!1,this.triggerArray=[],this.accordionElements=[],this.init()}init(){this.target=this.element.getAttribute("data-target")||this.element.getAttribute("href"),this.targetElement=document.querySelector(this.target),this.targetElement&&(this.element.setAttribute("aria-expanded","false"),this.targetElement.setAttribute("aria-hidden","true"),this.targetElement.style.height="0px",this.targetElement.style.overflow="hidden",this.targetElement.style.transition="height 0.35s ease",this.bindEvents(),this.options.parent&&this.handleAccordion())}bindEvents(){this.element.addEventListener("click",e=>{e.preventDefault(),this.toggle()})}handleAccordion(){const e=document.querySelector(this.options.parent);if(!e)return;const t=e.querySelectorAll('[data-toggle="collapse"]');t.forEach(t=>{t!==this.element&&(e=t.getAttribute("data-target")||t.getAttribute("href"),e=document.querySelector(e))&&this.accordionElements.push(e)})}toggle(){this.isTransitioning||(this.targetElement.classList.contains("show")?this.hide():this.show())}show(){if(this.isTransitioning||this.targetElement.classList.contains("show"))return;if(this.options.parent){this.accordionElements.forEach(e=>{if(e.classList.contains("show")){const t=Collapse.getInstance(e);t&&t.hide()}})}this.isTransitioning=!0,this.element.setAttribute("aria-expanded","true"),this.targetElement.setAttribute("aria-hidden","false"),this.targetElement.classList.add("show");const e=this.targetElement.scrollHeight;this.targetElement.style.height=e+"px";const t=()=>{this.targetElement.style.height="",this.targetElement.style.overflow="",this.isTransitioning=!1,this.targetElement.removeEventListener("transitionend",t),this.emitEvent("shown")};this.targetElement.addEventListener("transitionend",t),this.emitEvent("show")}hide(){if(this.isTransitioning||!this.targetElement.classList.contains("show"))return;this.isTransitioning=!0,this.targetElement.style.height=this.targetElement.scrollHeight+"px",this.targetElement.style.overflow="hidden",this.targetElement.offsetHeight,this.element.setAttribute("aria-expanded","false"),this.targetElement.setAttribute("aria-hidden","true"),this.targetElement.style.height="0px";const e=()=>{this.targetElement.classList.remove("show"),this.targetElement.style.height="",this.targetElement.style.overflow="",this.isTransitioning=!1,this.targetElement.removeEventListener("transitionend",e),this.emitEvent("hidden")};this.targetElement.addEventListener("transitionend",e),this.emitEvent("hide")}emitEvent(e){const t=new CustomEvent(`fw.${e}`,{detail:{collapse:this}});this.element.dispatchEvent(t)}static getInstance(e){return e._fwCollapse||null}static getOrCreateInstance(e,t={}){return e._fwCollapse||new Collapse(e,t)}}class Dropdown{constructor(e,t={}){this.element=e,this.options={offset:[0,2],flip:!0,boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null,...t},this.menu=null,this.isOpen=!1,this.init()}init(){const e=this.element.getAttribute("data-target")||this.element.getAttribute("href")||this.element.nextElementSibling;this.menu=document.querySelector(e),this.menu?(this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.menu.setAttribute("aria-hidden","true"),this.bindEvents()):console.warn("Dropdown menu not found for element:",this.element)}bindEvents(){this.element.addEventListener("click",e=>{e.preventDefault(),this.toggle()}),document.addEventListener("click",e=>{this.element.contains(e.target)||this.menu.contains(e.target)||this.hide()}),this.element.addEventListener("keydown",e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),this.toggle())}),this.menu.addEventListener("keydown",e=>{this.handleKeyboard(e)})}handleKeyboard(e){const t=this.menu.querySelectorAll(".fw-dropdown-item:not(.disabled)"),s=Array.from(t).findIndex(t=>t===document.activeElement);switch(e.key){case"ArrowDown":e.preventDefault();const i=(s+1)%t.length;t[i]?.focus();break;case"ArrowUp":e.preventDefault();const n=0===s?t.length-1:s-1;t[n]?.focus();break;case"Home":e.preventDefault(),t[0]?.focus();break;case"End":e.preventDefault(),t[t.length-1]?.focus();break;case"Escape":e.preventDefault(),this.hide(),this.element.focus();break;case"Enter":case" ":e.preventDefault(),document.activeElement.classList.contains("fw-dropdown-item")&&document.activeElement.click();break;case"Tab":this.hide()}}toggle(){this.isOpen?this.hide():this.show()}show(){if(this.isOpen)return;document.querySelectorAll(".fw-dropdown.show").forEach(e=>{const t=Dropdown.getInstance(e);t&&t.hide()}),this.isOpen=!0,this.element.classList.add("show"),this.menu.classList.add("show"),this.element.setAttribute("aria-expanded","true"),this.menu.setAttribute("aria-hidden","false"),this.position();const e=this.menu.querySelector(".fw-dropdown-item:not(.disabled)");e&&e.focus(),this.emitEvent("show")}hide(){this.isOpen||(this.isOpen=!1,this.element.classList.remove("show"),this.menu.classList.remove("show"),this.element.setAttribute("aria-expanded","false"),this.menu.setAttribute("aria-hidden","true"),this.emitEvent("hide"))}position(){const e=this.element.getBoundingClientRect(),t=this.menu.getBoundingClientRect(),s=window.innerHeight,i=s-e.bottom,n=e.top;if(i<t.height&&n>t.height)this.menu.style.top="auto",this.menu.style.bottom="100%",this.menu.style.marginBottom=this.options.offset[1]+"px";else this.menu.style.top="100%",this.menu.style.bottom="auto",this.menu.style.marginTop=this.options.offset[1]+"px";this.menu.style.left="0",this.menu.style.right="auto"}emitEvent(e){const t=new CustomEvent(`fw.${e}`,{detail:{dropdown:this}});this.element.dispatchEvent(t)}static getInstance(e){return e._fwDropdown||null}static getOrCreateInstance(e,t={}){return e._fwDropdown||new Dropdown(e,t)}}class Modal{constructor(e,t={}){this.element=e,this.options={backdrop:!0,keyboard:!0,focus:!0,show:!0,...t},this.isShown=!1,this.backdropElement=null,this.dialogElement=null,this.init()}init(){this.dialogElement=this.element.querySelector(".fw-modal-dialog"),this.bindEvents(),this.options.show&&this.show()}bindEvents(){this.element.querySelectorAll('[data-dismiss="modal"]').forEach(e=>{e.addEventListener("click",()=>this.hide())}),this.options.keyboard&&document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isShown&&this.hide()}),this.element.addEventListener("click",e=>{e.target===this.element&&this.options.backdrop&&this.hide()})}show(){if(this.isShown)return;this.options.backdrop&&this.createBackdrop(),this.isShown=!0,this.element.style.display="block",this.element.classList.add("show"),document.body.classList.add("fw-modal-open"),this.options.focus&&this.enforceFocus(),this.emitEvent("show"),setTimeout(()=>{this.trapFocus()},100)}hide(){this.isShown||(this.isShown=!1,this.element.classList.remove("show"),document.body.classList.remove("fw-modal-open"),setTimeout(()=>{this.element.style.display="none",this.removeBackdrop(),this.emitEvent("hidden")},300),this.emitEvent("hide"))}createBackdrop(){this.backdropElement=document.createElement("div"),this.backdropElement.className="fw-modal-backdrop fade",document.body.appendChild(this.backdropElement),this.backdropElement.offsetHeight,this.backdropElement.classList.add("show")}removeBackdrop(){this.backdropElement&&(this.backdropElement.classList.remove("show"),setTimeout(()=>{this.backdropElement&&this.backdropElement.parentNode&&(this.backdropElement.parentNode.removeChild(this.backdropElement),this.backdropElement=null)},300))}enforceFocus(){document.addEventListener("focusin",e=>{this.isShown&&!this.element.contains(e.target)&&(e.preventDefault(),this.element.focus())})}trapFocus(){const e=this.element.querySelectorAll("button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])");e.length>0&&e[0].focus()}emitEvent(e){const t=new CustomEvent(`fw.${e}`,{detail:{modal:this}});this.element.dispatchEvent(t)}static getInstance(e){return e._fwModal||null}static getOrCreateInstance(e,t={}){return e._fwModal||new Modal(e,t)}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('.fw-modal').forEach(e=>{Modal.getOrCreateInstance(e)}),document.querySelectorAll('[data-toggle="modal"]').forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const s=e.getAttribute("data-target")||e.getAttribute("href"),i=document.querySelector(s);i&&Modal.getOrCreateInstance(i).show()})}),document.querySelectorAll('[data-toggle="collapse"]').forEach(e=>{Collapse.getOrCreateInstance(e)}),document.querySelectorAll(".fw-dropdown").forEach(e=>{Dropdown.getOrCreateInstance(e)})});
